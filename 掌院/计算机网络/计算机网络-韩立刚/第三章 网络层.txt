网络层提供的服务：

   不同网络之间尽力转发数据包，基于数据包IP地址
   丢了不负责
   顺序不负责

路由器是三层设备，可以看到网络层
集线器：只是负责传递 一层设备
交换机：有存储功能  看目标MAC地址 选择出口  二层设备 


IP地址：10.0.0.0
子网掩码：255.0.0.0 表示10是网络部分，以此类推

网关一般都是网络中第一个能用的地址
 
应用层：准备要传输的文件                                              
传输层（段）：将文件分段并编号
网络层（包）：源IP 目标IP 
数据链路层（帧）：使用自己的子网掩码 判断自己属于哪个网段 
            使用自己的子网掩码 判断别人属于哪个网段
            如果同一个网段    arp协议广播解析目标IP地址的 mac地址
            如果不是一个网段  通过网关广播获取路由器的mac地址
物理层（比特流）：

路由器不可能中病毒，但是病毒可以影响路由器，比如频繁发送广播包，让路由器忙不归来



ARP协议 为IP服务 负责获取缓存mac地址  通讯之前的工作

将本网段(路由器隔绝广播)IP地址 通过广播 目标mac地址是FF-FF-FF-FF-FF-FF 解析目标IP地址的MAC地址
ping 网关 
arp -a 查看mac地址
arp -s 绑定mac地址
arp欺骗原理
  
  M4与M1通讯，发送广播包，M1回答是自己，这时，M2（装有黑客软件）赶紧告诉M4，是自己。
以后M4发的数据帧的mac地址都是M2，M2收到数据帧后，修改目标mac地址为M1，源mac地址是自己，
将信息发送给M1.这样，都经过了M2。


网络执法官原理

  M3（装有网络执法官），制定A与B不能通讯。A在解析B的mac地址的时候，M3也收到了，直接告诉A，mac地址为不存在的一个地址。
A将数据发送给这个不存在的地址，交换机发现不存在，直接扔掉。





ICMP网际控制报文协议

 ping 命令

 ping局域网 一般小于10ms

 TTL：粗略估计系统
 Linux 64
 Windows128
 Unix   255

 ping -t 一直ping
 ping -l 字节数200 发大包ping
 ping 8.8.8.8 -i 2 更改数据包TTL时间 能够跟踪数据包途径的路由器

 pathping（Windows）跟踪数据包路径 计算机丢包情况

 tracert ip 只跟踪


IGMP
  点到点：
  组播（多播）：一个包所有计算机都能收到 目标地址全F
  广播：一个教室内 学生听不同的课程。绑定不同多播地址。频道 


配置到路由器接口上，周期性的扫描哪些计算机绑定了多播地址


IP数据包：

        首部：一般20字节
              1.版本      4位
              2.首部长度  4位
              3.区分服务  8位       数据优先级  两个地方设置 路由器也要设置QOS
              4.总长度    16位      最大是65535个字节
              5.标识                编号 同编号表示是同一个数据包的分片
              6.标志      3位       表示是分片还是完整的数据包 1表示还有分片 0表示最后一个分片 
              7.片偏移              数据部分第一个字节除8
              8.生存时间：8位       TTL 每过一个路由器减一
              9.协议                指明交给谁处理 
             10.首部检验和          检验首部是否发生变化，0，否则丢弃
             11.源地址    32位
             12.目的地址  32位
             13.可变部分+填充
        数据部分：


        一个完整的数据包 标志位 010 片偏移位0
        ping IP -l 字节数

数据链路层最大1500字节，而网络层最大是65535字节，数据链路层会分片。一般情况下，数据包小于1500.
数据部分最大1480字节，如果不分片。
udp协议才会导致分片，tcp会分段

使用抓包工具 排除网络故障

  arp数据包会导致局域网阻塞，抓包工具可以抓到。
  


网络层协议：
     1.IP （统称） RIP OSPF 自动学习选择路径（动态路由）
     2.ARP
     3.ICMP
     4.IGMP
     
网络畅通条件：数据包有去有回

有的是没有到
有的是到了 没回来
一个网段根本不需要网关。
   
静态路由需要告诉所有没有直连的网络 下一跳要给谁

  RIP周期性广播路由表 30秒更新一下 它认为经过的跳数最少为最近  
  最大跳数为15跳 
  OSPF选择路径的标准为带宽


IP层次结构

  网络ID
  主机ID
  127.0.0.1 本地环回地址
  169.254.0.0 不能访问其他网段
  保留的私网地址
  10.0.0.0 
  172.16.0.0---172.31.0.0
  192.168.0.0---192.168.255.0
